{% extends "base.html" %}

{% block title %}ç®¡ç†åå°{% endblock %}

{% block content %}
    <h1>ğŸ”§ ç®¡ç†åå°</h1>

    <div class="admin-panel">
        <h2 style="color:#667eea">æ“ä½œé¢æ¿</h2>
        <div style="margin: 20px 0;">
            <a href="{{ url_for('add_server') }}" class="download-btn">æ·»åŠ æœåŠ¡å™¨</a>
            <a href="{{ url_for('upload_pack') }}" class="download-btn" style="margin-left: 10px;">ä¸Šä¼ æ•´åˆåŒ…</a>
        </div>
    </div>

    <!-- æœåŠ¡å™¨ç®¡ç† -->
    <div class="admin-panel">
        <h2 style="color:#667eea">ğŸ“‹ æœåŠ¡å™¨ç®¡ç†</h2>
        {% if servers %}
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f0f0f0;">
                        <th style="padding: 10px; text-align: left;">æœåŠ¡å™¨åç§°</th>
                        <th style="padding: 10px; text-align: left;">id</th>
                        <th style="padding: 10px; text-align: left;">åœ°å€</th>
                        <th style="padding: 10px; text-align: left;">ç‰ˆæœ¬</th>
                        <th style="padding: 10px; text-align: left;">çŠ¶æ€</th>
                        <th style="padding: 10px; text-align: left;">åœ¨çº¿ç©å®¶</th>
                        <th style="padding: 10px; text-align: left;">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for server in servers %}
                        <tr style="border-bottom: 1px solid #ddd;">
                            <td style="padding: 10px;">{{ server.name }}</td>

                            <!-- ç”¨äº JS æ”¶é›† serverId çš„å•å…ƒæ ¼ -->
                            <td data-server-id="{{ server.id }}" style="padding: 10px;">{{ server.id }}</td>

                            <td style="padding: 10px;">{{ server.ip }}:{{ server.port }}</td>
                            <td style="padding: 10px;">{{ server.version }}</td>

                            <!-- çŠ¶æ€åˆ— -->
                            <td style="padding: 10px;">
                                <span id="status-{{ server.id }}"
                                      class="server-status {{ 'status-online' if server.is_online else 'status-offline' }}">
                                    {{ 'åœ¨çº¿' if server.is_online else 'ç¦»çº¿' }}
                                </span>
                            </td>

                            <!-- åœ¨çº¿ç©å®¶åˆ— -->
                            <td style="padding: 10px;">
                                <span id="players-{{ server.id }}">
                                    {{ server.current_players }}/{{ server.max_players }}
                                </span>
                            </td>

                            <td style="padding: 10px;">
                                <div class="admin-actions">
                                    <a href="{{ url_for('edit_server', server_id=server.id) }}" class="admin-btn btn-edit">ç¼–è¾‘</a>
                                    <a href="{{ url_for('delete_server', server_id=server.id) }}" class="admin-btn btn-delete">åˆ é™¤</a>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>æš‚æ— æœåŠ¡å™¨</p>
        {% endif %}
    </div>

    <!-- æ•´åˆåŒ…ç®¡ç† -->
    <div class="admin-panel">
        <h2 style="color:#667eea">ğŸ“¦ æ•´åˆåŒ…ç®¡ç†</h2>
        {% if packs %}
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f0f0f0;">
                        <th style="padding: 10px; text-align: left;">æ•´åˆåŒ…åç§°</th>
                        <th style="padding: 10px; text-align: left;">ç‰ˆæœ¬</th>
                        <th style="padding: 10px; text-align: left;">ä¸‹è½½æ¬¡æ•°</th>
                        <th style="padding: 10px; text-align: left;">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pack in packs %}
                        <tr style="border-bottom: 1px solid #ddd;">
                            <td style="padding: 10px;">{{ pack.name }}</td>
                            <td style="padding: 10px;">{{ pack.version }}</td>
                            <td style="padding: 10px;">{{ pack.download_count }}</td>
                            <td style="padding: 10px;">
                                <div class="admin-actions">
                                    <a href="{{ url_for('download_pack', pack_id=pack.id) }}" class="admin-btn btn-edit">ä¸‹è½½</a>
                                    <a href="{{ url_for('delete_pack', pack_id=pack.id) }}" class="admin-btn btn-delete">åˆ é™¤</a>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>æš‚æ— æ•´åˆåŒ…</p>
        {% endif %}
    </div>
{% endblock %}